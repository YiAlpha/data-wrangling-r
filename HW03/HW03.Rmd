---
title: "HW03：for Loop & Function"
author: "YI YIN"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.path="images/",
                      cache.path="cache/",
                      cache=TRUE,
                      message=FALSE,
                      warning=FALSE)

```


## 1. Beer Song

### a) Write a loop
**Write a for loop that will iterate the main verse from 99 to 1. 
End with the last verse.**

Initialize a vector store the beer song
```{r}
beer_list <- vector(mode = "character", length = 99)
```

Iterate the main verse from 99 to 1
```{r}

for (i in 1: 99) {
        beer_list[i] <- paste(100-i, 'bottles of beer on the wall,',
                              100-i, 'bottles of beer.
                              Take one down, pass it around,', 
                             100-i-1, 'bottles of beer on the wall.')
}
```

End with the last verse.
```{r}
beer_list<- append(x = beer_list, 
       values = 'No more bottles of beer on the wall, no more bottles of beer.
       Go to the store and buy some more, 99 bottles of beer on the wall..' , after = 99)
```


Print steps 99 to 95 (that is from 99 bottles to 95 bottles) to the console. 
```{r}
beer_list[1:5]

```

### b) Convert loop to a function

**Now convert the loop into a function. Generalize to any type of liquid and a variable number of bottles (but assume the number of bottles entered is larger or equal to 3). Set the default values of your function arguments to the original song. **
Show the function code in solution
```{r}
song<- function(bottles = 3, liquid = 'Baileys'){
        list <- vector(mode = "character", length = bottles)
        for (i in 1: bottles) {
        list[i] <- paste(bottles+1-i, 
                                   'bottles of', 
                              liquid, 
                              'on the wall,',
                              bottles+1-i, 'bottles of ', 
                              liquid, '.',
                              'Take one down, pass it around,', 
                             bottles-i, 'bottles of',  
                             liquid ,
                             'on the wall.') 
        }
        list<- append(x = list, 
       values = paste('No more bottles of beer on the wall, no more bottles of',
                    liquid, '.',
                    'Go to the store and buy some more', bottles,'bottles of',
                    liquid, 'on the wall..'), after = bottles)
        print(list)
}
```

Print the output using the following values: 3, Whiskey.
```{r}
song(3, 'Whiskey')
```

### c) Add error check
**Add an error check to produce a warning when a user passes a non-numeric input to the number of bottles.**

```{r}
song_check <- function(bottles = 3, liquid = 'Baileys'){
        if(is.numeric(bottles) == FALSE ) stop('bottles is non-numeric')
        list <- vector(mode = "character", length = bottles)
        for (i in 1: bottles) {
        list[i] <- paste(bottles+1-i, 
                                   'bottles of', 
                              liquid, 
                              'on the wall,',
                              bottles+1-i, 'bottles of ', 
                              liquid, '.',
                              'Take one down, pass it around,', 
                             bottles-i, 'bottles of',  
                             liquid ,
                             'on the wall.') 
        }
        list<- append(x = list, 
       values = paste('No more bottles of beer on the wall, no more bottles of',
                    liquid, '.',
                    'Go to the store and buy some more', bottles,'bottles of',
                    liquid, 'on the wall..'), after = bottles)
        print(list)
}

```


### d) BONUS (optional): Convert loop to a fully generalized function

Generalize to any number (i.e no longer assume a minimum of 3) of any vessel containing liquid on any surface. Set the default values of your function arguments to the original song. 
```{r}
song_general <- function(bottles = 99, vessel= 'bottles' ,
                 liquid = 'beer', surface = 'wall'){
        if(is.numeric(bottles) == FALSE ) stop('vessels is non-numeric')
        if(bottles < 3 ) stop('vessels should be larger than 3')
        list <- vector(mode = "character", length = bottles)
        for (i in 1: bottles) {
        list[i] <- paste(bottles+1-i, 
                                   vessel,'of', 
                              liquid, 
                              'on the', surface,',',
                              bottles+1-i, vessel, 'of ', 
                              liquid, '.',
                              'Take one down, pass it around,', 
                             bottles-i, vessel,'of',  
                             liquid ,
                             'on the', surface,'.') 
        }
        list<- append(x = list, 
       values = paste('No more', vessel,  'of', liquid, 'on the', surface, 
                      'no more', vessel, 'of', liquid, '.',
                    'Go to the store and buy some more,',bottles, vessel,'of',
                    liquid, 'on the', surface, '..'), after = bottles)
        print(list)
}
```

Show the function code in your solution and print the output using the following values: 3, jugs,  milk, shelf.
```{r}

song_general(3, 'jugs',  'milk', 'shelf')
```

## 2. Draw a plot using a loop

```{r}
plot(1, type="n", xlab="", ylab="", xlim = c(0, 10), ylim = c(0, 10))
lines(x = c(1,1), y = c(1,7))
points(x = 3, y = 7)

```

### a) Plot with horizontal lines
Initialize a plot. Add 11 horizontal lines (from 0 to 10) using a for loop. Show the code of the loop and the plot in the output.
```{r}
plot(1, type="n", xlab="", ylab="", xlim = c(0, 11), ylim = c(0, 11))
for (i in 1:11){
        lines(x = c(0, 11), y = c(i, i))
}
```

### b) Add vertical lines
Extend the previous code, but now also add 11 vertical lines. Show the code and the changed plot in the output.
```{r}
plot(1, type="n", xlab="", ylab="", xlim = c(0, 11), ylim = c(0, 11))
for (i in 1:11){
        lines(x = c(0, 11), y = c(i, i))
        lines(x = c(i, i), y = c(0, 11))
}
```


## c) Add points
Lastly, add points() to the plot to all coordinate points where the lines intersect on the diagonals 
(that is the 45 and -45 degree lines). 
E.g. x=1,y=1 … x=1,y=9 etc. Again, show the code and the changed plot output.

```{r}
plot(1, type="n", xlab="", ylab="", xlim = c(0, 11), ylim = c(0, 11))
for (i in 1:11){
        lines(x = c(0, 11), y = c(i, i))
        lines(x = c(i, i), y = c(0, 11))
        for (j in 1:11){
            points(x = i, y = j)    
        }
}
```


### d) Convert to function
Convert this into a function that will allow the user to set the *size* of the plot (the plot should be square) and which *items* to draw (horizontal lines, vertical lines, points on the diagonal). 
Show the function you have written but no other output. 
Make sure the arguments of the function are set to sensible default values.

```{r}
square_plot <- function(size = 10, hline = T, vline =T, point =T){
        
        plot(1, type="n", xlab="", ylab="", 
             xlim = c(0, size), 
             ylim = c(0, size))
        
        if (hline == T){for (i in 1:size)
        {lines(x = c(0, size), y = c(i, i))}
                }
        
        if (vline == T){for (i in 1:size)
        {lines(x = c(i, i), y = c(0, size))}
                }

        if ( point == T){for (i in 1:size){
             for (j in 1: size){
                     points(x = i, y = j)}  
        }
                }


}

```

